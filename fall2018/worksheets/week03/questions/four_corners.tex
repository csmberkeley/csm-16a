% Author: Varsha, Henry
% Email: vio@berkeley.edu, tigerhs1998@berkeley.edu


% Looks at four subspaces, relationships between column and row space
% Has them recognize pivots as key to recognizing that row and column space have the same rank
%However, the row reduced forms are not shared! One reduced form is not the same as the other

\qns{Four corners}

In this question, we will be exploring the properties of the left nullspace. \\

$$\mathbf{A} = \begin{bmatrix} 4 & 6 & 2 & 2 \\ 2 & -3 & -1 & 1 \\ -2 & 9 & 3 & -1
\end{bmatrix}$$

\begin{enumerate}
\qitem Calculate the nullspace and column space of $\mathbf{A}$. What is the row-reduced form of $\mathbf{A}$? What is the span of the two spaces? \\

\meta{Make sure students remember that although you have to row reduce the matrix to find the pivot columns, the columns in the col space have to be pulled from the original matrix, not the row reduced form}

\ans{


$$ 
\begin{bmatrix}
2 & 3 & 1 & 1 \\
0 & -6 & -2 & 0 \\ 
0 & 12 & 4 & 0
\end{bmatrix}
\begin{matrix}
\mathbf{
     r_1 \gets 1/2r_1 \\
     r_2 \gets r_2 - 1/2r_1 \\
     r_3 \gets r_3 + 1/2r_1 \\
    }
\end{matrix}
$$
$$
\begin{bmatrix}
2 & 0 & 0 & 1 \\
0 & 3 & 1 & 0 \\ 
0 & 0 & 0 & 0 
 \end{bmatrix}
 \begin{matrix}
\mathbf{
     r_1 \gets r_1 + 1/2r_2 \\
     r_2 \gets -1/2r_2 \\
     r_3 \gets r_3 + 2r_2 \\
    }
\end{matrix}
$$


$$
\mathbf{\text{rref}(A) = }
\begin{bmatrix}
2 & 0 & 0 & 1 \\
0 & 3 & 1 & 0 \\
0 & 0 & 0 & 0
\end{bmatrix} \\$$
To get column space, we select the columns of the original matrix $\mathbf{A}$ that correspond with the pivots of $\mathbf{rref(A)}$.
$$\mathbf{colspace(A) = span}
\left\{
\begin{bmatrix}
4 \\ 2 \\ -2 
\end{bmatrix}, 
\begin{bmatrix} 
6 \\ -3 \\ 9
\end{bmatrix}
\right \}$$

To get the nullspace, solve $\mathbf{rref(A)} \cdot \vec{x} = \mathbf{0}$

$$ \begin{bmatrix}
  2 & 0 & 0 & 1 \\
  0 & 3 & 1 & 0 \\
  0 & 0 & 0 & 0\\
 \end{bmatrix}
 \begin{bmatrix}
  x_1 \\
  x_2 \\
  x_3 \\
  x_4
 \end{bmatrix} = 
 \begin{bmatrix}
  0 \\
  0 \\
  0 
 \end{bmatrix}
 $$
$$ 
\mathbf{null(A) = }
\left\{
\begin{bmatrix}
1 \\ 0 \\ 0 \\ -2
\end{bmatrix}, 
\begin{bmatrix} 
0 \\ 1 \\ -3 \\ 0
\end{bmatrix}
\right \}
$$
}

\qitem Calculate the row space and left nullspace of $\mathbf{A}$ (In other words, the column space and nullspace of $\mathbf{A^T}$). What is the row-reduced form of $\mathbf{A^T}$? What is the span of the two spaces?

\ans{
%Solution Here
$$ \mathbf{A^T} = \begin{bmatrix}
  4 & 2 & -2 \\
  6 & -3 & 9 \\
  2 & -1 & 3 \\
  2 & 1 & -1
 \end{bmatrix}$$
$$ 
 \begin{bmatrix}
  4 & 2 & -2 \\
  6 & -3 & 9 \\
  0 & 0 & 0 \\
  0 & 0 & 0
 \end{bmatrix}
 \begin{matrix}
\mathbf{
     \\
     \\ 
    r_3 \gets r_3 - 1/3r_2 \\
    r_4 \gets r_4 - 1/2r_1 \\
    }
\end{matrix}
 $$
$$ 
\begin{bmatrix}
  2 & 1 & -1 \\
  2 & -1 & 3 \\
  0 & 0 & 0 \\
  0 & 0 & 0
 \end{bmatrix}
 \begin{matrix}
    r_1 \gets 1/2r_1 \\
    r_2 \gets 1/3r_2 \\ 
       \\
       \\
\end{matrix}
 $$
$$
\begin{bmatrix}
  2 & 1 & -1 \\
  0 & 1 & -2 \\
  0 & 0 & 0 \\
  0 & 0 & 0
 \end{bmatrix}
 \begin{matrix}
     \\
    r_2 \gets 1/2(r_1-r_2) \\ 
       \\
       \\
\end{matrix}
 $$
$$
\begin{bmatrix}
  1 & 0 & 0.5 \\
  0 & 1 & -2 \\
  0 & 0 & 0 \\
  0 & 0 & 0
 \end{bmatrix}
 \begin{matrix}
    r_1 \gets 1/2(r_1-r_2) \\
      \\ 
       \\
       \\
\end{matrix}
 $$
$$
\mathbf{rref(A^T)} = 
\begin{bmatrix}
  1 & 0 & 0.5 \\
  0 & 1 & -2 \\
  0 & 0 & 0 \\
  0 & 0 & 0
 \end{bmatrix}
$$
 \\ \\
 The row space is the column space of $\mathbf{A^T}$, and the pivot columns of a matrix make up its column space.
    $$\mathbf{rowspace(A) = span}
    \left\{
    \begin{bmatrix}
    4 \\ 6 \\ 2 \\ 2
    \end{bmatrix}, 
    \begin{bmatrix} 
    2 \\ -3 \\ -1 \\ 1
    \end{bmatrix}
    \right \}$$
The left nullspace is the nullspace of $\mathbf{A^T}$. Solve the equation $\mathbf{rref(A^T)} \cdot \vec{x} = \mathbf{0}$

$$ \begin{bmatrix}
  1 & 0 & 0.5 \\
  0 & 1 & -2 \\
  0 & 0 & 0 \\
  0 & 0 & 0
 \end{bmatrix}
 \begin{bmatrix}
  x_1 \\
  x_2 \\
  x_3
 \end{bmatrix} = 
 \begin{bmatrix}
  0 \\
  0 \\
  0 \\
  0
 \end{bmatrix}
 $$
Select $x_3$ as your free variable, set $x_3 = t$, and solve for the other variables.

$$
x_3 = t, x_1 = -t/2, x_2 = 2t
$$
This can be written as
$$ 
\mathbf{null(A^T) = span}
\left\{
\begin{bmatrix}
-1/2 \\ 2 \\ 1 
\end{bmatrix}
\right\}
$$
}

\qitem Compare the rank of $\mathbf{A}$ and $\mathbf{A^T}$. What do you notice? Do you have any intuitive explanation behind the relationship? (Hint: Look at the row-reduced forms of $\mathbf{A}$ and $\mathbf{A^T}$)

\ans{
$$\mathbf{rank(A) = rank(A^T) = 2}$$
Why is this? Look at the pivots in the row reduced forms of $\mathbf{A}$ and $\mathbf{A^T}$; you'll notice they have the same number of pivots! Pivots are shared by columns and rows.
}

\qitem Take another look at the two row-reduced forms of $\mathbf{A}$ and $\mathbf{A^T}$. Can you use just one of them (for example, just $\mathbf{rref(A)}$) to find both the column space and the row space? How about the nullspace and left nullspace? Explain why or why not.

\ans{ Since pivots are preserved in both column and row reduction, we can in fact use either reduced echelon form to obtain the basis vectors for $\mathbf{A}$ and  $\mathbf{A^T}$. Row reduction on the rows, however, is not a valid operation on columns; so the reduced echelon forms will be different, and we cannot simply use the transpose to find the left nullspace from the nullspace, and vice versa.
}
\end{enumerate}