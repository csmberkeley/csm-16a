% Author: Sukrit Arora
% Email: sukrit.arora@berkeley.edu

\qns{Mechanical Eigenvectors and Eigenvalues}

\newcommand{\Amat}{\ensuremath{\begin{bmatrix}
3 & 2  \\
1 & 4
\end{bmatrix}}}

\sol{
    This problem is supposed to be straightforward, so make sure to stress the technique used in part (a), and let the students work amongst themselves for the rest of the question.
}

\begin{enumerate}

\qitem{
	Solve for the eigenvalue-eigenvector pairs for the following 2 by 2 matrix: \\
	$$
	\mathbf{A} = \Amat
    $$
}

\ans{
	To solve for eigenvalues and eigenvectors, let's go back and review the definition of eigenvectors and eigenvalues:
	\\
	If $\vec{x}$ and $\lambda$ are the eigenvector and eigenvalue of $\mathbf{A}$, respectively, then the following equation holds:
	
	$$\mathbf{A}\vec{x} = \lambda\vec{x}$$
	
	Since the (appropriately sized) identity matrix is analogous to multiplying by 1 in arithmetic, we can say:

    $$\mathbf{A}\vec{x} = \lambda \mathbf{I} \vec{x}$$
	
	Rearranging, we get:
	
	$$\mathbf{A}\vec{x} - (\lambda \mathbf{I}) \vec{x} = \vec{0}
	$$
	$$
	(\mathbf{A} - \lambda \mathbf{I})\vec{x} = \vec{0}
	$$
	
	What does this look like? It looks similar to solving for the nullspace of $(\mathbf{A} - \lambda \mathbf{I})$!
	
	Assuming that there is a nontrivial nullspace, that also means that $\mathbf{det}(\mathbf{A} - \lambda \mathbf{I}) = 0$!
	
	Let's solve for $\lambda$ first:
	
	$$(\mathbf{A} - \lambda \mathbf{I}) = \Amat - \begin{bmatrix}
	\lambda & 0 \\
	0 & \lambda
	\end{bmatrix}
	$$
	$$= \begin{bmatrix}
	3 - \lambda & 2 \\
	1 & 4 - \lambda
	\end{bmatrix}$$
	$$\mathbf{det}(\mathbf{A} - \lambda \mathbf{I}) = (3 - \lambda)(4 - \lambda) - 2$$
	$$= 10 - 7\lambda + \lambda^2$$
	$$= (\lambda - 5)(\lambda - 2)$$
	By factoring:
	$$\lambda = 5, 2$$
	
	Let's check: We've just solved for the eigenvalues. But what about the eigenvectors? 
	
	To do that, we plug in $\lambda$ into $(\mathbf{A} - \lambda \mathbf{I})$ and solve for the nullspace!
	
	For $\lambda = 5$:
	
	$$
	(\mathbf{A} - \lambda \mathbf{I})\vec{x} = \vec{0}
	$$
	$$\begin{bmatrix}
	3 - \lambda & 2 \\
	1 & 4 - \lambda
	\end{bmatrix}
	\begin{bmatrix} 
	x_1 \\
	x_2
	\end{bmatrix}= \vec{0}
	$$
	$$\begin{bmatrix}
	-2 & 2 \\
	1 & -1
	\end{bmatrix}
	\begin{bmatrix} 
	x_1 \\
	x_2
	\end{bmatrix} = \vec{0}
	$$
	By row reduction:
	$$\begin{bmatrix}
	1 & -1 \\
	0 & 0
	\end{bmatrix}
	\begin{bmatrix} 
	x_1 \\
	x_2
	\end{bmatrix} = \vec{0}
	$$
	$$
	x_1 = x_2 
	$$
	$$
	\begin{bmatrix} 
	x_1 \\
	x_2
	\end{bmatrix} = 
	\begin{bmatrix} 
	1 \\
	1
	\end{bmatrix}x_2
	$$
	So the first pair is $$\lambda = 5, \begin{bmatrix} 
	1 \\
	1
	\end{bmatrix}$$ \\
	Repeating for $\lambda = 2$, 
	$$\begin{bmatrix}
	3 - \lambda & 2 \\
	1 & 4 - \lambda
	\end{bmatrix}
	\begin{bmatrix} 
	x_1 \\
	x_2
	\end{bmatrix}= \vec{0}
	$$
	$$\begin{bmatrix}
	1 & 2 \\
	1 & 2
	\end{bmatrix}
	\begin{bmatrix} 
	x_1 \\
	x_2
	\end{bmatrix} = \vec{0}
	$$
	$$\begin{bmatrix}
	1 & 2 \\
	0 & 0
	\end{bmatrix}
	\begin{bmatrix} 
	x_1 \\
	x_2
	\end{bmatrix} = \vec{0}
	$$
	$$
	x_1 = -2x_2 
	$$
	$$
	\begin{bmatrix} 
	x_1 \\
	x_2
	\end{bmatrix} = 
	\begin{bmatrix} 
	-2 \\
	1
	\end{bmatrix}x_2
	$$
	So, the second pair is
	$$\lambda = 2, 
	\begin{bmatrix} 
	-2 \\
	1
	\end{bmatrix}$$
	}

\qitem{
	Find the eigenvectors for matrix \mathbf{A} given that we know that $\lambda_1 = 4, \lambda_2 = \lambda_3 = -2$ and that 
	$$ \mathbf{A} = 
	\begin{bmatrix} 1 & -3 & 3\\ 
	               3 & -5 & 3\\
	               6 & -6 & 4
	\end{bmatrix}
	$$
}

\ans{ 
    Once the eigenvalues of a matrix have been found, we can find the eigenvectors by Gaussian Elimination.
    
    Step 1: For each eigenvalue $\lambda$, we have $$(\mathbf{A - \lambda I})\vec{x} = 0$$
    where $\vec{x}$ is the eigenvector associated with eigenvalue $\lambda$.

    Step 2: Find \vec{x} in the nullspace of $(\mathbf{A - \lambda I})$ by plugging in a value of  $\lambda$ and using Gaussian elimination to solve.

    Case 1: $\lambda$ = 4. First, form the matrix $\mathbf{A - 4I}$:
    $$ \mathbf{A - 4I} = 
	\begin{bmatrix} -3 & -3 & 3\\ 
	               3 & -9 & 3\\
	               6 & -6 & 0
	\end{bmatrix}
	$$
	To make our numbers nicer, first let's divide our first row by -3
    $$R_1 = R_1 \cdot \frac{-1}{3}$$
    $$
    \begin{bmatrix} 1 & 1 & -1\\ 
	               3 & -9 & 3\\
	               6 & -6 & 0
	\end{bmatrix}
	$$
    
    $$R_2=R_2-3\cdot R_1$$
    $$R_3=R_3-6\cdot R_1$$
    $$
    \begin{bmatrix} 1 & 1 & -1\\ 
	               0 & -12 & 6\\
	               0 & -12 & 6
	\end{bmatrix}
	$$
	$$R_3=R_3-R_2$$
    $$R_2=R_2\cdot \frac{1}{6}$$
    $$
    \begin{bmatrix} 1 & 1 & -1\\ 
	               0 & -2 & 1\\
	               0 & 0 & 0
	\end{bmatrix}
	$$
	Now, we see that we have reached a row of 0s, which means that our last variable $x_3$ is the free variable in our system. Now, we can expand this matrix by putting it into a system of linear equations and solving for all the variables in terms of our free variable $x_3$
	$$x_1 +x_2 - x_3 = 0$$
	$$-2x_2 + x_3 = 0$$
	
	$$x_2 = \frac{x_3}{2}$$
	
	$$x_1 + \frac{x_3}{2} - x_3 = 0$$
	$$x_1 = \frac{x_3}{2}$$
	
	
	$$
    \vec{x} = \begin{bmatrix} \frac{x_3}{2} \\ \frac{x_3}{2} \\ x_3
    \end{bmatrix}
    $$
    
    $$
    = x_3 \begin{bmatrix} \frac{1}{2} \\ \frac{1}{2} \\ 1
    \end{bmatrix}, \forall x_3 \in \R
    $$
    
    So the eigenvector for when $\lambda = 4$ is $\vec{v}_1 =\begin{bmatrix} 1 \\ 1 \\ 2
    \end{bmatrix}$. Now, let's use this same technique to find the eigenvector for $\lambda = -2$

}

\sol{
    Here might be a good time to ask your students how many eigenvectors the next value of lambda yields considering that there are two lambda values that are equal to it
}

\ans{
    Case 2: Now let's plug in $\lambda = -2$ into $\mathbf{A-\lambda I}$ to get
    $$
    \mathbf{A + 2I} = \begin{bmatrix} 3 & -3 & 3 \\ 3 & -3 & 3 \\ 6 & -6  & 6\end{bmatrix}
    $$
	And, just like before, let's use Gaussian elimination to reduce the matrix. We can see that this will only take a few steps.
	
    $$R_2 = R_2 - R_1$$
    $$R_3 = R_3 - 2\cdot R_1$$
    $$R_1 = R_1 \cdot \frac{1}{3}$$
    $$
    \begin{bmatrix} 1 & 1 & -1\\ 
	               0 & 0 & 0\\
	               0 & 0 & 0
	\end{bmatrix}
    $$
    As we can see here, we have two rows of 0s, which means that we have two free variables ($x_2$ and $x_3$). Now we can take this matrix and write it as a linear system to get
	$$x_1 + x_2 - x_3 = 0 \Rightarrow x_1 = x_3 - x_2$$
	
	Thus, 
	
	$$\vec{x} = \begin{bmatrix} x_3 - x_2 \\  x_2 \\ x_3 \end{bmatrix} = x_3 \begin{bmatrix} 1\\  0 \\ 1 \end{bmatrix} + x_2 \begin{bmatrix} -1 \\  1 \\ 0 \end{bmatrix}$$
	Which are the two eigenvectors associated with $\lambda = -2$
}
\qitem{
	Find the eigenvalues for matrix $\mathbf{A}$ given that we know that $\vec{v}_1 = \begin{bmatrix} 1 \\ 1 \\1 \end{bmatrix}, \vec{v}_2 = \begin{bmatrix} 1 \\ 0 \\1 \end{bmatrix}, \vec{v}_3 = \begin{bmatrix} 0 \\ -1 \\1 \end{bmatrix}$ are the eigenvectors of $\mathbf{A}$, and that 
	$$ \mathbf{A} = 
	\begin{bmatrix} 3 & -1 & -1\\ 
	               2 & 1 & -2\\
	               0 & -1 & 2
	\end{bmatrix}
	$$
}

\ans{ 
    There are 2 ways to go about solving this problem. Either you can plug each eigenvector $\vec{v}_i$ into $\mathbf{A}v = \lambda v$ or the nullspace equation to come up with 3 equations and solve. As you have had a lot of practice with the latter, we will use the former to try to answer this question.
    
    Let's plug in the first eigenvector and solve for the first eigenvalue.
    
    $$\mathbf{A}\vec{v}_1 = \lambda_1\vec{v}_1$$
    $$
	\begin{bmatrix} 3 & -1 & -1\\ 
	               2 & 1 & -2\\
	               0 & -1 & 2
	\end{bmatrix} \begin{bmatrix} 1 \\ 1 \\1 \end{bmatrix} =\begin{bmatrix} 1 \\ 1 \\1 \end{bmatrix}
	$$
	
	So, we can see that $\lambda_1 = 1$. Similarly, we can do this for the other two eigenvectors.
	
	 $$
	\begin{bmatrix} 3 & -1 & -1\\ 
	               2 & 1 & -2\\
	               0 & -1 & 2
	\end{bmatrix} \begin{bmatrix} 1 \\ 0 \\1 \end{bmatrix} =\begin{bmatrix} 2 \\ 0 \\2 \end{bmatrix}
	$$
	
	So, we can see that $\lambda_2 = 2$.
	
	$$
	\begin{bmatrix} 3 & -1 & -1\\ 
	               2 & 1 & -2\\
	               0 & -1 & 2
	\end{bmatrix} \begin{bmatrix} 0 \\ -1 \\1 \end{bmatrix} =\begin{bmatrix} 0 \\ -3 \\3 \end{bmatrix}
	$$
	
	So, we can see that $\lambda_3 = 3$.

}

\end{enumerate}